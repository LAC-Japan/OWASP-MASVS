# V2: データストレージとプライバシーに関する要件

## 本章の目的

ユーザ認証情報や個人情報といった機密データの保護は、モバイルセキュリティにおいて最も重要な点です。もしIPCのようなOSの機能が適切に使用されていないと、同じデバイス上で実行されている他のアプリケーションに機密データが意図せずに漏えいする可能性があります。またデータはクラウドストレージやバックアップ、キーボードキャッシュに意図せずに漏えいするかもしれません。さらに他のデバイスと比べるとモバイルデバイスは容易に紛失したり、盗難にあう恐れがあり、その場合、物理的アクセスを手に入れた悪意ある者にとっては好都合となるでしょう。そのようなケースでは、機密データの取り出しがより困難となるように、追加の防御策をとることもできます。

ここで留意すべき点は、MASVSはアプリケーションを中心に捉えているため、MDMソリューションによって守られるデバイスレベルのポリシーをカバーしていないことです。さらに高いデータセキュリティが求められる状況ではそうしたデバイスレベルのポリシーの適用を推奨します。

### 機密データの定義

MASVSにおける機密データとは、ユーザ認証情報およびそれ以外の次の機密情報を指します。

- 盗難により不正利用につながる個人識別情報(PII)：社会保障番号、クレジットカード番号、銀行口座番号、医療関連情報
- 被害を受けると、評判の低下や財務的損失につながる高い機密情報：契約情報、未公開/未発表情報、管理情報
- 法律やコンプライアンスの理由で保護されなければならない全てのデータ

## セキュリティ検証要件

発覚した大部分のデータ漏えいの問題は、簡単なルールに従うことにより防ぐことができます。尚、この章で記載されているほとんどの対策は、全ての検証標準レベルで必須となります。

| # | 説明 | L1 | L2 |
| --- | --- | --- | --- |
| **2.1** | ユーザ認証情報や暗号鍵などの機密データを保存するために、システムの認証情報の保存機能が適切に使用されている | ✓ | ✓ |
| **2.2** | アプリケーションのログファイルに機密データが書き出されていない | ✓ | ✓ |
| **2.3** | アーキテクチャの一部として必要でない限り、機密データをサードパーティと共有していない | ✓ | ✓ |
| **2.4** | 機密データの入力時にキーボードのキャッシュが無効化されている | ✓ | ✓ |
| **2.5** | 機密データを含んでいるかもしれないテキストフィールドでクリップボードが無効となっている | ✓ | ✓ |
| **2.6** | IPCの機能を経由して機密データが漏えいしていない | ✓ | ✓ |
| **2.7** | パスワードやPINなどの機密データがユーザインタフェースを通して漏えいしていない | ✓ | ✓ |
| **2.8** | モバイルデバイスのOSによって生成されたバックアップに機密データが含まれていない |   | ✓ |
| **2.9** | アプリケーションがバックグラウンドに移った時に、機密データをビュー(画面表示用データ)から削除している |  | ✓ |
| **2.10** | アプリケーションが機密データを必要以上に長時間メモリ上に保持していない、また機密データの使用後にメモリから明示的にクリアされている |  | ✓ |
| **2.11** | ユーザに端末のパスコードを設定するなど最小限のデバイスアクセスセキュリティポリシーをアプリケーションが要求している |  | ✓ |
| **2.12** | アプリケーションを使う時にユーザが従うべきセキュリティのベストプラクティスと、アプリケーションが扱っている個人情報の種別をユーザに知らせている |  | ✓ |

## 参考文献

OWASPモバイルセキュリティテストガイドには、本セクションに記載されている要件を検証するための詳細な手順が記載されています。

- For Android - https://github.com/OWASP/owasp-mstg/blob/master/Document/0x05d-Testing-Data-Storage.md
- For iOS - https://github.com/OWASP/owasp-mstg/blob/master/Document/0x06d-Testing-Data-Storage.md

詳細は以下を参照してください。

- OWASP Mobile Top 10: M2  - Insecure Data Storage(安全でないデータストレージ): https://www.owasp.org/index.php/Mobile_Top_10_2016-M2-Insecure_Data_Storage
- CWE: https://cwe.mitre.org/data/definitions/922.html
